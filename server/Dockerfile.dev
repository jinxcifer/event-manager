FROM node:18.12.1-alpine3.15 as base

ENV NODE_ENV=$NODE_ENV
ENV BACKEND_PORT=$BACKEND_PORT
ENV DATABASE_USERNAME=$DATABASE_USERNAME
ENV DATABASE_PASSWORD=$DATABASE_PASSWORD
ENV DATABASE_HOST=$DATABASE_HOST
ENV DATABASE_PORT=$DATABASE_PORT
ENV DATABASE_NAME=$DATABASE_NAME

# 1. STEP: INSTALL DEPENDENCIES

WORKDIR /app

## Install dependencies
COPY package.json yarn.lock tsconfig.json tsconfig.build.json ./
RUN yarn --non-interactive

CMD ["yarn", "start:dev"]
